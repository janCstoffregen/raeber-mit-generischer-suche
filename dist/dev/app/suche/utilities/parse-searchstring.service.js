"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var ParseSearchstringService = (function () {
    function ParseSearchstringService() {
    }
    ParseSearchstringService.prototype.parseSearchString = function (unparsedSearch) {
        var quoteSplit = unparsedSearch.split('"');
        var queryWords = [];
        for (var i = 0; i < quoteSplit.length; i++) {
            if (i % 2 === 0 && quoteSplit[i] !== '') {
                var restWordSplit = quoteSplit[i].trim().split(' ');
                for (var j = 0; j < restWordSplit.length; j++) {
                    if (restWordSplit[j] === 'intitle:' || restWordSplit[j] === 'intext:' || restWordSplit[j] === 'OR') {
                        queryWords.push({ 'searchString': restWordSplit[j], 'where': 'open' });
                    }
                    else {
                        queryWords.push({ 'searchString': restWordSplit[j], 'where': 'anywhere' });
                    }
                }
            }
            else if (quoteSplit[i] !== '') {
                queryWords.push({ 'searchString': quoteSplit[i], 'where': 'anywhere' });
            }
        }
        for (var i = 0; i < queryWords.length; i++) {
            if (queryWords[i].searchString === 'intitle:' && queryWords[i].where === 'open' && queryWords[i + 1]) {
                queryWords[i].where = 'delete';
                queryWords[i + 1].where = 'title';
            }
            else if (queryWords[i].searchString === 'intitle:' && queryWords[i].where === 'open' && i === queryWords.length) {
                queryWords[i].where = 'anywhere';
            }
            else if (queryWords[i].searchString === 'intext:' && queryWords[i].where === 'open' && queryWords[i + 1]) {
                queryWords[i].where = 'delete';
                queryWords[i + 1].where = 'text';
            }
            else if (queryWords[i].searchString === 'intext:' && queryWords[i].where === 'open' && i === queryWords.length) {
                queryWords[i].where = 'anywhere';
            }
            else if (queryWords[i].searchString === 'OR' && queryWords[i].where === 'open' && i === 0) {
                queryWords[i].where = 'anywhere';
            }
            else if (queryWords[i].searchString === 'OR' && queryWords[i].where === 'open' && i === queryWords.length) {
                queryWords[i].where = 'anywhere';
            }
        }
        var queries = [];
        var queryEntry = [];
        for (var i = 0; i < queryWords.length; i++) {
            if (queryWords[i].searchString === 'OR' && queryWords[i].where === 'open' && i !== 0 && i !== queryWords.length) {
                queries.push(queryEntry);
                queryEntry = [];
            }
            else if (queryWords[i].where !== 'delete') {
                queryEntry.push({ 'searchString': queryWords[i].searchString, 'where': queryWords[i].where });
            }
        }
        queries.push(queryEntry);
        return queries;
    };
    return ParseSearchstringService;
}());
ParseSearchstringService = __decorate([
    core_1.Injectable()
], ParseSearchstringService);
exports.ParseSearchstringService = ParseSearchstringService;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zdWNoZS91dGlsaXRpZXMvcGFyc2Utc2VhcmNoc3RyaW5nLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFHQSxzQ0FBMkM7QUFHM0MsSUFBYSx3QkFBd0I7SUFBckM7SUErRUEsQ0FBQztJQXhFQyxvREFBaUIsR0FBakIsVUFBa0IsY0FBc0I7UUFFdEMsSUFBSSxVQUFVLEdBQUcsY0FBYyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUMzQyxJQUFJLFVBQVUsR0FBZSxFQUFFLENBQUM7UUFFaEMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxVQUFVLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFFM0MsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBR3hDLElBQUksYUFBYSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ3BELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsYUFBYSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO29CQUU5QyxFQUFFLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEtBQUssVUFBVSxJQUFJLGFBQWEsQ0FBQyxDQUFDLENBQUMsS0FBSyxTQUFTLElBQUksYUFBYSxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUM7d0JBRW5HLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBQyxjQUFjLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUMsQ0FBQyxDQUFDO29CQUN2RSxDQUFDO29CQUFDLElBQUksQ0FBQyxDQUFDO3dCQUVOLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBQyxjQUFjLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUMsQ0FBQyxDQUFDO29CQUMzRSxDQUFDO2dCQUNILENBQUM7WUFDSCxDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUVoQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUMsY0FBYyxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFDLENBQUMsQ0FBQztZQUN4RSxDQUFDO1FBQ0gsQ0FBQztRQUdELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQzNDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLEtBQUssVUFBVSxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEtBQUssTUFBTSxJQUFJLFVBQVUsQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUVuRyxVQUFVLENBQUUsQ0FBQyxDQUFFLENBQUMsS0FBSyxHQUFHLFFBQVEsQ0FBQztnQkFDakMsVUFBVSxDQUFFLENBQUMsR0FBRyxDQUFDLENBQUUsQ0FBQyxLQUFLLEdBQUcsT0FBTyxDQUFDO1lBQ3RDLENBQUM7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksS0FBSyxVQUFVLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssS0FBSyxNQUFNLElBQUksQ0FBQyxLQUFLLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO2dCQUVsSCxVQUFVLENBQUUsQ0FBQyxDQUFFLENBQUMsS0FBSyxHQUFHLFVBQVUsQ0FBQztZQUNyQyxDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLEtBQUssU0FBUyxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEtBQUssTUFBTSxJQUFJLFVBQVUsQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUV6RyxVQUFVLENBQUUsQ0FBQyxDQUFFLENBQUMsS0FBSyxHQUFHLFFBQVEsQ0FBQztnQkFDakMsVUFBVSxDQUFFLENBQUMsR0FBRyxDQUFDLENBQUUsQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDO1lBQ3JDLENBQUM7WUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLFlBQVksS0FBSyxTQUFTLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssS0FBSyxNQUFNLElBQUksQ0FBQyxLQUFLLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO2dCQUVqSCxVQUFVLENBQUUsQ0FBQyxDQUFFLENBQUMsS0FBSyxHQUFHLFVBQVUsQ0FBQztZQUNyQyxDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLEtBQUssSUFBSSxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEtBQUssTUFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUU1RixVQUFVLENBQUUsQ0FBQyxDQUFFLENBQUMsS0FBSyxHQUFHLFVBQVUsQ0FBQztZQUNyQyxDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLEtBQUssSUFBSSxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEtBQUssTUFBTSxJQUFJLENBQUMsS0FBSyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztnQkFFNUcsVUFBVSxDQUFFLENBQUMsQ0FBRSxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUM7WUFDckMsQ0FBQztRQUNILENBQUM7UUFFRCxJQUFJLE9BQU8sR0FBc0IsRUFBRSxDQUFDO1FBQ3BDLElBQUksVUFBVSxHQUFlLEVBQUUsQ0FBQztRQUVoQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUMzQyxFQUFFLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxLQUFLLElBQUksSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxLQUFLLE1BQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztnQkFHaEgsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztnQkFDekIsVUFBVSxHQUFHLEVBQUUsQ0FBQztZQUNsQixDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQztnQkFHNUMsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFDLGNBQWMsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxFQUFFLE9BQU8sRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFDLENBQUMsQ0FBQztZQUM5RixDQUFDO1FBQ0gsQ0FBQztRQUVELE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFFekIsTUFBTSxDQUFDLE9BQU8sQ0FBQztJQUNqQixDQUFDO0lBQ0gsK0JBQUM7QUFBRCxDQS9FQSxBQStFQyxJQUFBO0FBL0VZLHdCQUF3QjtJQURwQyxpQkFBVSxFQUFFO0dBQ0Esd0JBQXdCLENBK0VwQztBQS9FWSw0REFBd0IiLCJmaWxlIjoiYXBwL3N1Y2hlL3V0aWxpdGllcy9wYXJzZS1zZWFyY2hzdHJpbmcuc2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBSZXRvIEJhdW1nYXJ0bmVyIChyZmJhdW1nYXJ0bmVyKSBvbiAxNi4wOC4xNy5cbiAqL1xuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgUGFyc2VTZWFyY2hzdHJpbmdTZXJ2aWNlIHtcblxuICAvLyBleHBlY3RzIGEgc2VhcmNocXVlcnkgbGlrZSAnXCJwYWxtIHRyZWVzXCIgYXBwbGVzIE9SIGludGV4dDogcGVhcnMnXG4gIC8vIHJldHVybnMgYW4gYXJyYXkgb2YgYW4gYXJyYXkgY29udGFpbmluZyBhIG1hcCBwZXIgd29yZCBsaWtlXG4gIC8vIFsgW3tzZWFyY2hTdHJpbmc6IFwicGFsbSB0cmVlc1wiLCB3aGVyZTogXCJhbnl3aGVyZVwifSwge3NlYXJjaFN0cmluZzogXCJhcHBsZXNcIiwgd2hlcmU6IFwiYW55d2hlcmVcIn1dLFxuICAvLyAgIFt7c2VhcmNoU3RyaW5nOiBcInBlYXJzXCIsIHdoZXJlOiBcInRleHRcIn1dIF1cblxuICBwYXJzZVNlYXJjaFN0cmluZyh1bnBhcnNlZFNlYXJjaDogc3RyaW5nKSB7XG5cbiAgICBsZXQgcXVvdGVTcGxpdCA9IHVucGFyc2VkU2VhcmNoLnNwbGl0KCdcIicpOyAvLyBxdW90YXRpb24gbWFya3MgaGF2ZSB0aGUgaGlnaGVzdCBwcmVjZWRlbmN5LiBTcGxpdCBvbiB0aGVtIGZpcnN0LlxuICAgIGxldCBxdWVyeVdvcmRzOiBBcnJheTxhbnk+ID0gW107IC8vIGxpc3QgZm9yIHRoZSB3b3JkcyBvZiB0aGUgdW5wYXJzZWQgc2VhcmNoXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHF1b3RlU3BsaXQubGVuZ3RoOyBpKyspIHtcblxuICAgICAgaWYgKGkgJSAyID09PSAwICYmIHF1b3RlU3BsaXRbaV0gIT09ICcnKSB7XG4gICAgICAgIC8vIHdvcmRzIGluIGV2ZW4gcGxhY2VzIGFyZSBjb25zaWRlcmVkIGFzIG91dHNpZGUgb2YgcXVvdGF0aW9uIG1hcmtzXG5cbiAgICAgICAgbGV0IHJlc3RXb3JkU3BsaXQgPSBxdW90ZVNwbGl0W2ldLnRyaW0oKS5zcGxpdCgnICcpO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHJlc3RXb3JkU3BsaXQubGVuZ3RoOyBqKyspIHtcblxuICAgICAgICAgIGlmIChyZXN0V29yZFNwbGl0W2pdID09PSAnaW50aXRsZTonIHx8IHJlc3RXb3JkU3BsaXRbal0gPT09ICdpbnRleHQ6JyB8fCByZXN0V29yZFNwbGl0W2pdID09PSAnT1InKSB7XG4gICAgICAgICAgICAvLyBmdW5jdGlvbmFsIHdvcmRzIGFyZSBtYXJrZWQgd2l0aCB3aGVyZTpvcGVuXG4gICAgICAgICAgICBxdWVyeVdvcmRzLnB1c2goeydzZWFyY2hTdHJpbmcnOiByZXN0V29yZFNwbGl0W2pdLCAnd2hlcmUnOiAnb3Blbid9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gbm9uLWZ1bmN0aW9uYWwgd29yZHMgYXJlIGRlZmF1bHRlZCB0byBiZSBsb29rZWQgZm9yIGV2ZXJ5d2hlcmVcbiAgICAgICAgICAgIHF1ZXJ5V29yZHMucHVzaCh7J3NlYXJjaFN0cmluZyc6IHJlc3RXb3JkU3BsaXRbal0sICd3aGVyZSc6ICdhbnl3aGVyZSd9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAocXVvdGVTcGxpdFtpXSAhPT0gJycpIHtcbiAgICAgICAgLy8gd29yZHMgaW4gb2RkIHBsYWNlcyBhcmUgY29uc2lkZXJlZCB0byBiZSBpbiBxdW90YXRpb24gbWFya3NcbiAgICAgICAgcXVlcnlXb3Jkcy5wdXNoKHsnc2VhcmNoU3RyaW5nJzogcXVvdGVTcGxpdFtpXSwgJ3doZXJlJzogJ2FueXdoZXJlJ30pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNsZWFudXAgZnVuY3Rpb25hbCB3b3Jkc1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcXVlcnlXb3Jkcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHF1ZXJ5V29yZHNbaV0uc2VhcmNoU3RyaW5nID09PSAnaW50aXRsZTonICYmIHF1ZXJ5V29yZHNbaV0ud2hlcmUgPT09ICdvcGVuJyAmJiBxdWVyeVdvcmRzW2krMV0pIHtcbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgYSB3b3JkIGFmdGVyLCBpbnRpdGxlIGlzIHNldCB0byB0aGF0IHdvcmQncyBwcm9wZXJ0eSBhbmQgbWFya2VkIHRvIGJlIGRlbGV0ZWRcbiAgICAgICAgcXVlcnlXb3Jkc1sgaSBdLndoZXJlID0gJ2RlbGV0ZSc7XG4gICAgICAgIHF1ZXJ5V29yZHNbIGkgKyAxIF0ud2hlcmUgPSAndGl0bGUnO1xuICAgICAgfSBlbHNlIGlmIChxdWVyeVdvcmRzW2ldLnNlYXJjaFN0cmluZyA9PT0gJ2ludGl0bGU6JyAmJiBxdWVyeVdvcmRzW2ldLndoZXJlID09PSAnb3BlbicgJiYgaSA9PT0gcXVlcnlXb3Jkcy5sZW5ndGgpIHtcbiAgICAgICAgLy8gaWYgaW50aXRsZTogaXMgdGhlIGxhc3Qgd29yZCBpdCBpcyB0cmVhdGVkIGxpa2UgYSBub3JtYWwgd29yZFxuICAgICAgICBxdWVyeVdvcmRzWyBpIF0ud2hlcmUgPSAnYW55d2hlcmUnO1xuICAgICAgfSBlbHNlIGlmIChxdWVyeVdvcmRzW2ldLnNlYXJjaFN0cmluZyA9PT0gJ2ludGV4dDonICYmIHF1ZXJ5V29yZHNbaV0ud2hlcmUgPT09ICdvcGVuJyAmJiBxdWVyeVdvcmRzW2krMV0pIHtcbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgYSB3b3JkIGFmdGVyLCBpbnRleHQgaXMgc2V0IHRvIHRoYXQgd29yZCdzIHByb3BlcnR5IGFuZCBtYXJrZWQgdG8gYmUgZGVsZXRlZFxuICAgICAgICBxdWVyeVdvcmRzWyBpIF0ud2hlcmUgPSAnZGVsZXRlJztcbiAgICAgICAgcXVlcnlXb3Jkc1sgaSArIDEgXS53aGVyZSA9ICd0ZXh0JztcbiAgICAgIH0gZWxzZSBpZiAocXVlcnlXb3Jkc1tpXS5zZWFyY2hTdHJpbmcgPT09ICdpbnRleHQ6JyAmJiBxdWVyeVdvcmRzW2ldLndoZXJlID09PSAnb3BlbicgJiYgaSA9PT0gcXVlcnlXb3Jkcy5sZW5ndGgpIHtcbiAgICAgICAgLy8gaWYgaW50ZXh0OiBpcyB0aGUgbGFzdCB3b3JkIGl0IGlzIHRyZWF0ZWQgbGlrZSBhIG5vcm1hbCB3b3JkXG4gICAgICAgIHF1ZXJ5V29yZHNbIGkgXS53aGVyZSA9ICdhbnl3aGVyZSc7XG4gICAgICB9IGVsc2UgaWYgKHF1ZXJ5V29yZHNbaV0uc2VhcmNoU3RyaW5nID09PSAnT1InICYmIHF1ZXJ5V29yZHNbaV0ud2hlcmUgPT09ICdvcGVuJyAmJiBpID09PSAwKSB7XG4gICAgICAgIC8vIGlmIE9SIGlzIHRoZSBmaXJzdCB3b3JkIGl0IGlzIHRyZWF0ZWQgbGlrZSBhIG5vcm1hbCB3b3JkXG4gICAgICAgIHF1ZXJ5V29yZHNbIGkgXS53aGVyZSA9ICdhbnl3aGVyZSc7XG4gICAgICB9IGVsc2UgaWYgKHF1ZXJ5V29yZHNbaV0uc2VhcmNoU3RyaW5nID09PSAnT1InICYmIHF1ZXJ5V29yZHNbaV0ud2hlcmUgPT09ICdvcGVuJyAmJiBpID09PSBxdWVyeVdvcmRzLmxlbmd0aCkge1xuICAgICAgICAvLyBpZiBPUiBpcyB0aGUgbGFzdCB3b3JkIGl0IGlzIHRyZWF0ZWQgbGlrZSBhIG5vcm1hbCB3b3JkXG4gICAgICAgIHF1ZXJ5V29yZHNbIGkgXS53aGVyZSA9ICdhbnl3aGVyZSc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IHF1ZXJpZXM6IEFycmF5PEFycmF5PGFueT4+ID0gW107IC8vIHF1ZXJpZXMgZGl2aWRlZCBieSBPUlxuICAgIGxldCBxdWVyeUVudHJ5OiBBcnJheTxhbnk+ID0gW107IC8vIHF1ZXJ5IHdvcmRzIGRpdmlkZWQgYnkgQU5EXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHF1ZXJ5V29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChxdWVyeVdvcmRzW2ldLnNlYXJjaFN0cmluZyA9PT0gJ09SJyAmJiBxdWVyeVdvcmRzW2ldLndoZXJlID09PSAnb3BlbicgJiYgaSAhPT0gMCAmJiBpICE9PSBxdWVyeVdvcmRzLmxlbmd0aCkge1xuICAgICAgICAvLyBvbiBPUiAoaWYgbm90IGluIHRoZSBmaXJzdCBvciBsYXN0IGVsZW1lbnQpIGEgbmV3IHF1ZXJ5IGFycmF5IGlzIHN0YXJ0ZWRcblxuICAgICAgICBxdWVyaWVzLnB1c2gocXVlcnlFbnRyeSk7XG4gICAgICAgIHF1ZXJ5RW50cnkgPSBbXTtcbiAgICAgIH0gZWxzZSBpZiAocXVlcnlXb3Jkc1tpXS53aGVyZSAhPT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgLy8gYWxsIG5vcm1hbCB3b3JkcyBvZiB0aGUgcXVlcnkgYXJlIGNvbGxlY3RlZCBpbiB0aGUgQU5EIGxpc3RcblxuICAgICAgICBxdWVyeUVudHJ5LnB1c2goeydzZWFyY2hTdHJpbmcnOiBxdWVyeVdvcmRzW2ldLnNlYXJjaFN0cmluZywgJ3doZXJlJzogcXVlcnlXb3Jkc1tpXS53aGVyZX0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHF1ZXJpZXMucHVzaChxdWVyeUVudHJ5KTtcblxuICAgIHJldHVybiBxdWVyaWVzO1xuICB9XG59XG4iXX0=
